;; Mcafee Antispam
;; plugin_id: 1618
;; type: detector 
;; description: Mcafee Antispam
;;

[DEFAULT]
plugin_id=1618

[config]
type=detector
enable=yes

source=log
location=/var/log/SYSLOG/antispam/mcafee.log

# create log file if it does not exists, 
# otherwise stop processing this plugin
create_file=true

process=
start=no   
stop=no
startup=
shutdown=

#Ryslog template
#$template antispam,"%timereported% %fromhost% %msg%\n"

#Jul 25 06:33:19 13.37.13.37 30:32|21|72627921|0|100|Message received. Received IP <('13.37.13.37', 16382)> From <sukupeco3217@brasiltelecom.net.br> To <['3dgbellas@endesa.es']> Route Domain <endesa.es> Route Host = <13.37.13.37,13.37.13.37>|[]
[Mcafee-Antispam-3-Message-received]
event_type=event
regexp="(?P<date>\w+\s\d+\s\d+:\d+:\d+)\s(?P<sensor>[^\s]+)\s+\d+:\d+\|(?P<sport>\d+)\|\d+\|0\|100\|Message received.\s+Received IP\s+\<\(.(?P<sip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*From\s+\<(?P<ssender>(?P<suser>\w+)@(?P<sdomain>\D+))>\s+To\s+<\['(?P<dsender>(?P<duser>\w+)@(?P<ddomain>\D+))']>.*"
plugin_sid=100
date={normalize_date($date)}
sensor={resolv($sensor)}
src_ip={$sip}
dst_ip={resolv($sensor)}
src_port = {$sport}
dst_port = 25
userdata1 = {$ssender}
userdata2 = {$suser}
userdata3 = {$sdomain}
userdata4 = {$dsender}
userdata5 = {$duser}
userdata6 = {$ddomain}

[Mcafee-Antispam-1-Spam-received]
event_type=event
regexp="(?P<date>\w+\s\d+\s\d+:\d+:\d+)\s(?P<sensor>[^\s]+)[^\|]+\|\d+\|(?P<src_ip>[^-]+)-(?P<sport>\d+)\|1\|102\|.*Sender:(?P<sender>(?P<user>[^@]+)@(?P<domain>[^,]+))"
plugin_sid=102
date={normalize_date($date)}
sensor={resolv($sensor)}
src_ip={$src_ip}
dst_ip={resolv($sensor)}
src_port = {$sport}
dst_port = 25
userdata1 = {$sender}
userdata2 = {$user}
userdata3 = {$domain}

[Mcafee-Antispam-2-Message-Quarantined]
event_type=event
regexp="(?P<date>\w+\s\d+\s\d+:\d+:\d+)\s(?P<sensor>[^\s]+)[^\|]+\|\d+\|(?P<src_ip>[^-]+)-(?P<sport>\d+)\|\d+\|108\|.*"
plugin_sid=108
date={normalize_date($date)}
sensor={resolv($sensor)}
src_ip={$src_ip}
dst_ip={resolv($sensor)}
src_port = {$sport}
dst_port = 25

