;; ironport.cfg
;; plugin_id: 1591
;; 
;;
;;  This program is free software: you can redistribute it and/or modify
;;  it under the terms of the GNU General Public License as published by
;;  the Free Software Foundation, either version 3 of the License, or
;;  (at your option) any later version.
;;
;;  This program is distributed in the hope that it will be useful,
;;  but WITHOUT ANY WARRANTY; without even the implied warranty of
;;  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;;  GNU General Public License for more details.
;;
;;  You should have received a copy of the GNU General Public License
;;  along with this program.  If not, see <http://www.gnu.org/licenses/>.

[DEFAULT]
plugin_id=1591

[config]
type=detector
enable=yes

source=log
location=/var/log/syslog-ng/rmail.log
create_file=false

process=
start=no
stop=no
startup=
shutdown=


[IronPort Virus detected]
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 256 antivirus positive 'EICAR-AV-Test'
#Jan 28 09:40:10 rmail2 syslog_logs: Info: MID 1745 antivirus repaired 'W32/Netsky-P'
event_type=event
regexp=(\SYSLOG_DATE)\s+(\S+)\s+\S+: Info: MID (\S+) antivirus (positive|repaired) '([^\']+)'
plugin_sid=1
date={normalize_date($1)}
sensor={resolv($2)}
userdata1={$2}
userdata2={$3}
userdata4={$4}
userdata3={$5}


[IronPort Mensaje dropped by filter]
#Jan 15 13:33:11 rmail1 syslog_logs: Info: Message aborted MID 25781 Dropped by filter 'drop_zip_c'
event_type=event
regexp=(\SYSLOG_DATE)\s+(\S+)\s+\S+: Info: Message aborted MID (\S+) Dropped by filter '([^\']+)'
plugin_sid=2
date={normalize_date($1)}
sensor={resolv($2)}
userdata1={$2}
userdata2={$3}
userdata3={$4}


[IronPort SPAM quarantine]
#Jan 15 13:33:11 rmail1 syslog_logs: Info: EUQ: Quarantined MID 2317877
event_type=event
regexp=(\SYSLOG_DATE)\s+(\S+)\s+\S+: Info: EUQ: Quarantined MID (\S+)
plugin_sid=3
date={normalize_date($1)}
sensor={resolv($2)}
userdata1={$2}
userdata2={$3}


[IronPort SPAM positive]
#Jan 15 13:33:16 rmail1 syslog_logs: Info: MID 30 using engine: CASE spam positive
event_type=event
regexp=(\SYSLOG_DATE)\s+(\S+)\s+\S+: Info: MID (\S+) using engine: (\S+) spam positive
plugin_sid=4
date={normalize_date($1)}
sensor={resolv($2)}
userdata1={$2}
userdata2={$3}
userdata3={$4}


### More log samples:

#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 256 ICID 44784 From: <test@virus.org>
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 256 ICID 44784 RID 0 To: <joe@example.com>
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 256 Message-ID '<137398.@virus.org>'
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 256 Subject 'Virus Scanner Test #22'
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 256 ready 1627 bytes from <test@virus.org>
#Jan 15 13:33:11 rmail1 syslog_logs: Warning: MID 256, Message Scanning Problem: Continuation line seen before first header
#Jan 15 13:33:11 rmail1 syslog_logs: Info: ICID 44784 close
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 256 antivirus positive 'EICAR-AV-Test'
#Jan 15 13:33:11 rmail1 syslog_logs: Info: Message aborted MID 256 Dropped by antivirus
#Jan 15 13:33:11 rmail1 syslog_logs: Info: Message finished MID 256 done
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 257 ICID 44785 From: test@virus.org
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 257 ICID 44785 RID 0 To: <joe@example.com>
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 257 Message-ID '<392912.@virus.org>'
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 25781 Subject 'Virus Scanner Test #22'
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 257 ready 1627 bytes from <test@virus.org>
#Jan 15 13:33:11 rmail1 syslog_logs: Warning: MID 257, Message Scanning Problem: Continuation line seen before first header
#Jan 15 13:33:11 rmail1 syslog_logs: Info: Message aborted MID 25781 Dropped by filter 'drop_zip_c'
#Jan 15 13:33:11 rmail1 syslog_logs: Info: Message finished MID 257 done
#Jan 15 13:33:11 rmail1 syslog_logs: Info: ICID 44785 close
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 2317877 ICID 15726925 From: <HLD@chasehf.bfi0.com>
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 2317877 ICID 15726925 RID 0 To: <stevel@healthtrust.org>
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 2317877 Message-ID '<W1TH05606E5811BEA0734309D4BAF0.323.14460.pimailer44.DumpShot.2@email.chase.com>'
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 2317877 Subject 'Envision your dream home - Now make it a reality'
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 2317877 ready 15731 bytes from <HLD@chasehf.bfi0.com>
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 2317877 matched all recipients for per-recipient policy DEFAULT in the inbound table
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 2317877 using engine: CASE spam suspect
#Jan 15 13:33:11 rmail1 syslog_logs: Info: EUQ: Tagging MID 2317877 for quarantine
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 2317877 antivirus negative
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 2317877 queued for delivery
#Jan 15 13:33:11 rmail1 syslog_logs: Info: RPC Delivery start RCID 756814 MID 2317877 to local IronPort Spam Quarantine
#Jan 15 13:33:11 rmail1 syslog_logs: Info: EUQ: Quarantined MID 2317877
#Jan 15 13:33:11 rmail1 syslog_logs: Info: RPC Message done RCID 756814 MID 2317877
#Jan 15 13:33:11 rmail1 syslog_logs: Info: Message finished MID 2317877 done
#Jan 15 13:33:11 rmail1 syslog_logs: Info: MID 30 ICID 120 From: <anon@anonfrom.comma>
#Jan 15 13:33:15 rmail1 syslog_logs: Info: MID 30 ICID 120 RID 0 To: <anon@anonto.comma>
#Jan 15 13:33:15 rmail1 syslog_logs: Info: MID 30 SPF: helo identity postmaster@TNZXUGLS None
#Jan 15 13:33:15 rmail1 syslog_logs: Info: MID 30 SPF: mailfrom identity anon@anonfrom.com None
#Jan 15 13:33:16 rmail1 syslog_logs: Info: MID 30 Message-ID '<000d01c9770d$2deb8620$6400a8c0@anfonfrom>'
#Jan 15 13:33:16 rmail1 syslog_logs: Info: MID 30 Subject 'FW: New salary structure'
#Jan 15 13:33:16 rmail1 syslog_logs: Info: MID 30 ready 1350 bytes from <anon@anonfrom.com>
#Jan 15 13:33:16 rmail1 syslog_logs: Info: MID 30 matched all recipients for per-recipient policy DEFAULT in the inbound table
#Jan 15 13:33:16 rmail1 syslog_logs: Info: MID 30 interim verdict using engine: CASE spam positive
#Jan 15 13:33:16 rmail1 syslog_logs: Info: MID 30 using engine: CASE spam positive
#Jan 15 13:33:16 rmail1 syslog_logs: Info: Message aborted MID 30 Dropped by CASE
#Jan 15 13:33:16 rmail1 syslog_logs: Info: Message finished MID 30 done

