;; Aruba Wireless
;; plugin_id: 1623
;; 
;; $Id: 
;; amachuca

[DEFAULT]
plugin_id=1623

[config]
type=detector
enable=yes

source=log
location=/var/log/ossim/aruba.log
create_file=false

process=tail
start=no	; launch plugin process when agent starts
stop=no     ; shutdown plugin process when agent stops
startup=
shutdown=

# list of sids (comma separated) to be excluded by the detector
#exclude_sids=

[translation]
Probe request=	1
Auth request=  2
Auth success=	3
Disassoc fro=4
Deauth fro=5
Station DN=	6
Station UP=	7
Deauth to sta=	9


[AP-ACCESS-event]
event_type=event
#regexp=(\S+\s\s\S+\s\S+\s\S+)\s.(\S+).\s\S+\s\S+\s\S+\s\S+\s\s((\S+\s\S+)|(\S+\s\S+\s\S+)).\s(\S+|\S+\s\S+)\s(\S+)\s(.{15})-(.{17})-(\S+)\s.*
regexp=(\w{3}\s\s\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s.(\S+).\s\S+\s\S+\s\S+\s\S+\s\s((\S+\s\S+)|(\S+\s\S+\s\S+)).\s(\S+)\s(\S+\s\S+)\s(.{15})-(.{17})-(\S+)\s.*


sensor={$2}
plugin_sid={translate($3)}
src_ip={resolv($8)}
date={normalize_date($1)}
userdata1={$4}
userdata2={$6}
userdata3={$7}


[Interfering-AP-detected]
event_type=event
regexp="(\w{3}\s\s\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s.(\S+).\s\S+\s\S+\s\S+\s\|AP\s(.*)\@(\S+)\s\S+\s\sAM\s(\S+)\s.*SSID\s(\S+)\sand\sBSSID\s(\S+)"
sensor={$2}
plugin_sid=7
src_ip={$2}
date={normalize_date($1)}
userdata1={$3}
userdata2={$4}
userdata3={$5}
userdata4={$6}
userdata5={$7}



[AP-stats]
event_type=event
regexp="(\w{3}\s\s\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s.(\S+).\s\S+\s\S+\s\S+\s\|AP\s(.*)\@(\S+)\s\S+\s\sAM\:\sRadio\sStats\:\sAPs\=(\S+)\sSTAs\=(\S+)\sMon\-APs\=(\S+)\sMon\-STAs\=(\S+)"

sensor={$2}
plugin_sid=8
src_ip={$4}
date={normalize_date($1)}
userdata1={$3}
userdata2={$4}
userdata3={$5}
userdata4={$6}
userdata5={$7}
userdata5={$8}


[Station-up-or-down]
event_type=event
regexp="(\w{3}\s\s\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s.(\S+).\s\S+\s\S+\s\S+\s\|authmgr\|\s\sMAC\=(.{17})\s(\S+\s\S+)\:\sBSSID\=(.{17})\sESSID\=(\S+)\sVLAN\=(\S+)\sAP\-name\=(\S+).*"


sensor={$2}
plugin_sid={translate($4)}
src_ip={$2}
date={normalize_date($1)}
userdata1={$3}
userdata3={$5}
userdata4={$6}
userdata5={$7}
userdata5={$8}

