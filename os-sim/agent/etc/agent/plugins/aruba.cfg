;; Aruba Wireless
;; plugin_id: 1623
;; 
;; $Id: 
;; amachuca && pcatalina

[DEFAULT]
plugin_id=1623

[config]
type=detector
enable=yes

source=log
location=/var/log/ossim/aruba.log
create_file=false

process=tail
start=no	; launch plugin process when agent starts
stop=no     ; shutdown plugin process when agent stops
startup=
shutdown=

# list of sids (comma separated) to be excluded by the detector
#exclude_sids=

[translation]
Probe request=1
Auth request=2
Auth success=3
Disassoc from sta=4
Deauth from sta=5
Station DN=6
Station UP=7
Deauth to sta=9
Assoc request=10
Assoc success=11
Assoc failure=12
Auth failure=13
Source=14
calling remove_pot_sta=15
calling remove_ap=16
calling remove_pot_ap=17
set_mode called for=18
called for=19
Adding new Gateway MAC:=20
unable to find AP=21
Received disassociation=22
Received association=23
Authentication Successful=26
Authentication failed=27
AAA server timeout=28
Station authenticated=29
Station deauthenticated=30
User entry added=31
User entry deleted=32
User miss=33

[STM]
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\S+\s+(?P<trans>Deauth\s+to\s+sta|Deauth\s+from\s+sta|Disassoc\s+from\s+sta|Auth\s+success|Auth\s+request|Probe\s+request|Assoc\s+request|Assoc\s+success|Assoc\s+failure|Auth\s+failure|Source)(\s+@\s\d\d\:\d\d:\d\d\.\d+)?:\s+(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})([^\:]+:)?.?\s+(?P<act>Dropped|Moved\s+out\s+from|Ageout|Failed)?\s*AP\s+(?P<ap>(?P<ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).+\.\d+)\s(?P<desc>.*)"
sensor={resolv($sensor)}
plugin_sid={translate($trans)}
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$mac}
userdata2={$ap}
userdata3={$trans}
userdata4={$act}
userdata5={$desc}

[STM-Station]
#Aug 26 10:25:15 2010 [13.37.13.37] stm[1672]: <501044> <NOTI> |stm|  Station 00:12:f0:46:b9:80: No authentication found trying to de-authenticate to BSSID 00:0b:86:a7:30:70 on AP monte da condesa.13
#Aug 22 14:42:46 2010 [13.37.13.37] stm[1672]: <501037> <NOTI> |stm|  Station 00:24:2c:3f:2c:30: no association found trying to disassociate to BSSID 00:0b:86:a5:fd:30 on AP monte da condesa.14
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\S+\s+Station\s+(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}):\s+(?P<trans>.+BSSID)\s+(?P<bssid>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+on\s+AP\s+(?P<ap>.+\.\d+)"
sensor={resolv($sensor)}
plugin_sid=34
date={normalize_date($date)}
userdata1={$mac}
userdata2={$ap}
userdata3={$trans}
userdata4={$bssid}

[STM-CDR]
#Aug 17 15:07:30 2010 [13.37.13.37] stm[1672]: <503292> <INFO> |stm|  VM: 13.37.13.37 9 CDR started
#Aug 17 15:07:45 2010 [13.37.13.37] stm[1672]: <503293> <INFO> |stm|  VM: 13.37.13.37 9 CDR ended
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\S+\s+VM:\s+(?P<ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<cdr>\d+)\s+(?P<stat>.+)"
sensor={resolv($sensor)}
plugin_sid=35
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$cdr}
userdata2={$stat}

[STM-VoIP]
#Aug 17 15:07:31 2010 [13.37.13.37] stm[1672]: <503071> <INFO> |stm|  VM: vm_update_client_call_status 7643: 13.37.13.37 VoIP call started
#Aug 23 01:36:05 2010 [13.37.13.37] stm[1672]: <503062> <INFO> |stm|  VM: vm_update_client_call_status 7635: VoIP call terminated for 13.37.13.37
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\S+\s+VM:\s+vm_update_client_call_status\s+\d+:\s+(?P<desc>VoIP\s+call\s+terminated\s+for)?\s*(?P<ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s*(?P<desc2>VoIP\s+call\s+started)?"
sensor={resolv($sensor)}
plugin_sid=36
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$desc}
userdata2={$desc2}

[SAPD-Radio_Stats]
#Aug 15 06:35:07 2010 [13.37.13.37] sapd[189]: <326091> <NOTI> |AP cm fonseca.11@13.37.13.37 sapd|  AM: Radio Stats: APs=5 STAs=1 Mon-APs=1 Mon-STAs=0
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|AP\s+(?P<ap>[^@]+)@(?P<ip>[^\|]+)\s+sapd\|\s+AM:\s+Radio\s+Stats:\s+APs=(?P<APs>\d+)\s+STAs=(?P<STAs>\d+)\s+Mon-APs=(?P<MonAPs>\d+)\s+Mon-STAs=(?P<MonSTAs>\d+)"
sensor={resolv($sensor)}
plugin_sid=8
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$ap}
userdata2={$APs}
userdata3={$STAs}
userdata4={$MonAPs}
userdata5={$MonSTAs}


[SAPD-Interfering-AP-detected]
#Aug 15 07:29:41 2010 [13.37.13.37] sapd[245]: <404003> <WARN> |AP monte da condesa.7@13.37.13.37 sapd|  AM 00:0b:86:a5:f9:80: Interfering AP detected with SSID  and BSSID 00:02:cf:4d:a8:e5
#Aug 15 07:29:42 2010 [13.37.13.37] sapd[171]: <404003> <WARN> |AP farmacia.16@13.37.13.37 sapd|  AM 00:1a:1e:68:bb:c0: Interfering AP detected with SSID R-Wlan4a and BSSID 00:18:9b:05:58:50
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|AP\s+(?P<ap>[^@]+)@(?P<ip>[^\|]+)\s+sapd\|\s+AM\s+(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}):\s+Interfering\s+AP\s+detected\s+with\s+SSID\s(?P<SSID>.+)?\sand\s+BSSID\s+(?P<bssid>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})"
sensor={resolv($sensor)}
plugin_sid=48
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$ap}
userdata2={$mac}
userdata3={$SSID}
userdata4={$bssid}

[SAPD-Interfering-AP-detected]
#Aug 17 11:38:08 2010 [13.37.13.37] sapd[466]: <404080> <ERRS> |AP cc.ee.1@13.37.13.37 sapd|  AM 00:1a:1e:68:c4:50: ADHOC network detected with Src 00:26:55:08:e1:82, BSSID 02:25:a5:5d:1e:5c, ESSID hpsetup Channel 6 and RSSI 1
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|AP\s+(?P<ap>[^@]+)@(?P<ip>[^\|]+)\s+sapd\|\s+AM\s+(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}):\s+ADHOC\s+network\s+detected\s+with\s+Src\s+(?P<macsrc>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}),\s+BSSID\s+(?P<bssid>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}),\s+ESSID\s(?P<SSID>.+)?\sChannel\s+(?P<channel>\d+)\s+and\s+RSSI\s+(?P<RSSI>\d+)"
sensor={resolv($sensor)}
plugin_sid=37
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$ap}
userdata2={$mac}
userdata3={$SSID}
userdata4={$bssid}
userdata5={$macsrc}
userdata6={$channel}
userdata7={$RSSI}



[SAPD-RSTA]
#Aug 17 11:51:40 2010 [13.37.13.37] sapd[180]: <326107> <NOTI> |AP cm fonseca.12@13.37.13.37 sapd|  AM: RSTA Type set to 0 for STA 00:22:b0:69:8b:63
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|AP\s+(?P<ap>[^@]+)@(?P<ip>[^\|]+)\s+sapd\|\s+AM:\s+RSTA\s+Type\s+set\s+to\s+(?P<rsta>\d+)\s+for\s+STA\s+(?P<sta>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})"
sensor={resolv($sensor)}
plugin_sid=38
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$ap}
userdata2={$rsta}
userdata3={$sta}


[SAPD-Bridge]
#Aug 26 09:56:04 2010 [13.37.13.37] sapd[599]: <404081> <ERRS> |AP dereito.16@13.37.13.37 sapd|  AM 00:0b:86:3a:5c:70: Wireless bridge detected with Transmitter 00:14:bf:ef:2e:77, Receiver 00:10:e7:f5:d4:6a, Channel 9 and RSSI=0
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|AP\s+(?P<ap>[^@]+)@(?P<ip>[^\|]+)\s+sapd\|\s+AM\s+(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}):\s+Wireless\s+bridge\s+detected\s+with\s+Transmitter\s+(?P<trans>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}),\s+Receiver\s+(?P<receiver>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}),\s+Channel\s+(?P<channel>\d+)\s+and\s+RSSI=(?P<RSSI>\d+)"
sensor={resolv($sensor)}
plugin_sid=39
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$ap}
userdata2={$mac}
userdata3={$trans}
userdata4={$receiver}
userdata5={$channel}
userdata6={$RSSI}

[SAPD-Intolerance]
#Aug 25 23:10:42 2010 [13.37.13.37] sapd[619]: <404091> <WARN> |AP bioloxia.11@13.37.13.37 sapd|  AM 00:1a:1e:69:05:d0: HT 40MHZ Intolerance setting detected for AP BSSID f8:1e:df:fd:ca:51 SSID epecNetCore Channel 11
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|AP\s+(?P<ap>[^@]+)@(?P<ip>[^\|]+)\s+sapd\|\s+AM\s+(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}):\s+(?P<desc>.*)Intolerance\s+setting\s+detected\s+for\s+AP\s+BSSID\s+(?P<bssid>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+SSID\s(?P<SSID>.+)?\sChannel\s+(?P<channel>\d+)"
sensor={resolv($sensor)}
plugin_sid=40
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$ap}
userdata2={$mac}
userdata3={$desc}
userdata4={$bssid}
userdata5={$SSID}
userdata6={$channel}

[SAPD-calling_remove]
#Aug 25 12:42:40 2010 [13.37.13.37] sapd[310]: <326011> <NOTI> |AP monte da condesa.13@13.37.13.37 sapd|  AM: calling remove_pot_sta 00:12:f0:46:b9:80
#Aug 19 17:24:46 2010 [13.37.13.37] sapd[354]: <326010> <NOTI> |AP monte da condesa.25@13.37.13.37 sapd|  AM: calling remove_ap 00:0b:86:a9:0f:92
#Aug 20 03:23:28 2010 [13.37.13.37] sapd[171]: <326012> <NOTI> |AP quimica.10@13.37.13.37 sapd|  AM: calling remove_pot_ap 00:1a:1e:69:0c:c2
#Aug 24 10:08:42 2010 [13.37.13.37] sapd[413]: <326148> <NOTI> |AP monte da condesa.18@13.37.13.37 sapd|  AM: set_mode called for 00:0b:86:a9:0f:90 type 1 active 1
#Aug 24 10:08:42 2010 [13.37.13.37] sapd[413]: <326009> <NOTI> |AP monte da condesa.18@13.37.13.37 sapd|  AM: called for 00:0b:86:a9:0f:90
#Aug 25 13:08:11 2010 [13.37.13.37] sapd[218]: <326205> <NOTI> |AP monte da condesa.11@13.37.13.37 sapd|  AM: Adding new Gateway MAC: 00:11:88:05:5a:01
#Aug 25 11:38:09 2010 [13.37.13.37] sapd[177]: <326205> <NOTI> |AP farmacia.8@13.37.13.37 sapd|  AM: Adding new Gateway MAC: sapd|  ^[mac 00:11:88:05:5a:01
#Aug 24 10:01:22 2010 [13.37.13.37] sapd[198]: <326102> <NOTI> |AP monte da condesa.19@13.37.13.37 sapd|  AM: unable to find AP 00:0b:86:a5:f1:c0
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|AP\s+(?P<ap>[^@]+)@(?P<ip>[^\|]+)\s+sapd\|\s+AM:\s+(?P<trans>calling\s+remove_pot_sta|calling\s+remove_ap|calling\s+remove_pot_ap|set_mode\s+called\s+for|called\s+for|Adding\s+new\s+Gateway\s+MAC:|unable\s+to\s+find\s+AP)\s+(sapd\|\s+\^\[mac\s+)?(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})(\s+type\s+(?P<type>\d+)\s+active\s+(?P<active>\d+))?"
sensor={resolv($sensor)}
plugin_sid={translate($trans)}
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$ap}
userdata2={$mac}
userdata3={$trans}
userdata5={$type}
userdata6={$active}

[SAPD-Attack]
#Aug 26 10:23:52 2010 [13.37.13.37] sapd[198]: <404054> <ERRS> |AP monte da condesa.13@13.37.13.37 sapd|  AM 00:0b:86:a7:30:70: Disconnect-Station Attack: Disassoc frame from 00:12:f0:46:b9:80 is invalid, RSSI=10 DisassocSeq=1031 NormalSeq=1743 Mismatched=1 Similar=0
#Aug 26 12:20:31 2010 [13.37.13.37] sapd[198]: <404054> <ERRS> |AP monte da condesa.13@13.37.13.37 sapd|  AM 00:0b:86:a7:30:70: Disconnect-Station Attack: Auth frame from 00:12:f0:46:b9:80 is invalid, RSSI=11 AuthSeq=2280 NormalSeq=312 Mismatched=3 Similar=2
#Aug 26 11:04:55 2010 [13.37.13.37] sapd[171]: <404054> <ERRS> |AP pservizos.5@13.37.13.37 sapd|  AM 00:1a:1e:c5:29:70: Disconnect-Station Attack: Deauth frame from 00:1a:1e:c5:2a:20 is invalid, RSSI=11 DeauthSeq=4095 NormalSeq=13 Mismatched=2 Similar=0
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|AP\s+(?P<ap>[^@]+)@(?P<ip>[^\|]+)\s+sapd\|\s+AM\s+(?P<macap>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}):\s+Disconnect-Station\s+Attack:\s+(?P<desc>.+)\s+(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+is\s+invalid,\s+(?P<resto>.+)"
sensor={resolv($sensor)}
plugin_sid=41
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$ap}
userdata2={$macap}
userdata3={$desc}
userdata5={$mac}
userdata6={$resto}

[SAPD-Signatures]
#Aug 21 18:58:20 2010 [13.37.13.37] sapd[144]: <326227> <ERRS> |AP chus.5@13.37.13.37 sapd|  AM 00:1a:1e:c5:26:40: Signature Match detected. SignatureName="Deauth-Broadcast" Src=00:80:5a:5c:df:72 Dst=ff:ff:ff:ff:ff:ff Bssid=00:80:5a:5c:df:72 Channel=6 RSSI=4
#Aug 25 05:42:05 2010 [13.37.13.37] sapd[171]: <326227> <ERRS> |AP quimica.11@13.37.13.37 sapd|  AM 00:1a:1e:69:0c:c0: Signature Match detected. SignatureName="Null-Probe-Response" Src=00:1c:10:ab:05:54 Dst=00:1c:b3:73:3e:76 Bssid=00:1c:10:ab:05:54 Channel=11 RSSI=2
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|AP\s+(?P<ap>[^@]+)@(?P<ip>[^\|]+)\s+sapd\|\s+AM\s+(?P<macap>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}):\s+Signature\s+Match\s+detected\.\s+SignatureName=\"(?P<signature>[^\"]+)\"\s+Src=(?P<src>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+Dst=(?P<dst>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+Bssid=(?P<bssid>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+Channel=(?P<channel>\d+)\s+RSSI=(?P<rssi>\d+)"
sensor={resolv($sensor)}
plugin_sid=42
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$ap}
userdata2={$macap}
userdata3={$signature}
userdata5={$src}
userdata6={$dst}
userdata7={$bssid}
userdata8={$channel}
userdata9={$rssi}


[MOBILEIP-recieved]
#Aug 15 06:36:20 2010 [13.37.13.37] mobileip[1698]: <500511> <INFO> |mobileip|  Station d4:9a:20:b9:0f:b5, 13.37.13.37: Received disassociation on ESSID: congresoscondesa Mobility service ON, HA Discovery on Association Off, Fastroaming Disabled, AP: Name monte da condesa.8 Group monte da condesa BSSID 00:0b:86:a9:2b:10, phy g, VLAN 44
#Aug 15 06:35:31 2010 [13.37.13.37] mobileip[1698]: <500511> <INFO> |mobileip|  Station d4:9a:20:b9:0f:b5, 13.37.13.37: Received association on ESSID: congresoscondesa Mobility service ON, HA Discovery on Association Off, Fastroaming Disabled, AP: Name monte da condesa.8 Group monte da condesa BSSID 00:0b:86:a9:2b:10, phy g, VLAN 44
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|mobileip\|\s+Station\s+(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}),\s+(?P<ip>\S+):\s+(?P<trans>Received\s+disassociation|Received\s+association)\s+on\s+ESSID:\s(?P<essid>.*)\sMobility\s+service\s+(?P<mob>\S+),\s+HA\s+Discovery\s+on\s+Association\s+(?P<ha>\S+),\s+Fastroaming\s+(?P<roa>\S+),\s+AP:\s(?P<ap>.+\.\d+)\sGroup\s(?P<group>.+)\sBSSID\s+(?P<bssid>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}),\s+phy\s+(?P<phy>\S+),\s+VLAN\s+(?P<vlan>\S+)"
sensor={resolv($sensor)}
plugin_sid={translate($trans)}
src_ip={resolv($ip)}
date={normalize_date($date)}
userdata1={$mac}
userdata2={$essid}
userdata3={$mob}
userdata4={$ha}
userdata5={$roa}
userdata6={$ap}
userdata7={$group}
userdata8={$bssid}
userdata9={$phy}

[MOBILEIP-Mobility]
#Aug 15 06:35:31 2010 [13.37.13.37] mobileip[1698]: <500010> <NOTI> |mobileip|  Station d4:9a:20:b9:0f:b5, 13.37.13.37: Mobility trail, on switch 13.37.13.37, VLAN 44, AP monte da condesa.8, congresoscondesa/00:0b:86:a9:2b:10/g
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|mobileip\|\s+Station\s+(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2}),\s+(?P<ip>\S+):\s+Mobility\s+trail,\s+on\s+switch\s+(?P<switch>\S+),\s+VLAN\s+(?P<vlan>\S+),\s+AP\s(?P<ap>.+\.\d+),\s(?P<group>[^\/]+)\/(?P<bssid>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})"
sensor={resolv($sensor)}
plugin_sid=43
src_ip={resolv($ip)}
dst_ip={resolv($switch)}
date={normalize_date($date)}
userdata1={$mac}
userdata2={$vlan}
userdata3={$ap}
userdata4={$group}
userdata5={$bssid}

[AUTHMGR-StationUPDN]
#Aug 15 06:38:42 2010 [13.37.13.37] authmgr[18121]: <522035> <INFO> |authmgr|  MAC=58:b0:35:02:dd:6c Station UP: BSSID=00:0b:86:a6:5e:51 ESSID=wifiusc-web VLAN=39 AP-name=cm fonseca.3
#Aug 15 06:51:09 2010 [13.37.13.37] authmgr[18121]: <522036> <INFO> |authmgr|  MAC=34:15:9e:da:f0:54 Station DN: BSSID=00:1a:1e:69:09:b1 ESSID=wifiusc-web VLAN=39 AP-name=monte da condesa.21
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|authmgr\|\s+MAC=(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+(?P<trans>Station\s+UP|Station\s+DN):\s+BSSID=(?P<bssid>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+ESSID=(?P<essid>.*)\sVLAN=(?P<vlan>\S+)\s+AP-name=(?P<ap>.+\.\d+)"
sensor={resolv($sensor)}
plugin_sid={translate($trans)}
date={normalize_date($date)}
userdata1={$mac}
userdata2={$bssid}
userdata3={$essid}
userdata4={$vlan}
userdata5={$ap}



[AUTHMGR-Station_auth]
#Aug 15 21:47:53 2010 [13.37.13.37] authmgr[18121]: <522029> <INFO> |authmgr|  MAC=00:04:e2:ce:bf:bb Station authenticated: method=802.1x, role=eduroam, VLAN=40/40/0
#Aug 15 18:40:34 2010 [13.37.13.37] authmgr[18121]: <522030> <INFO> |authmgr|  MAC=00:21:e9:e2:37:98 Station deauthenticated: BSSID=00:1a:1e:c5:2b:83, ESSID=wifiusc
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|authmgr\|\s+MAC=(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+(?P<trans>Station\s+authenticated|Station\s+deauthenticated):\s+\S+=(?P<usr1>\S+),\s+(ESSID=(?P<essid>.*))?(role=(?P<role>[^,]+),\s+VLAN=(?P<vlan>\S+))?"
sensor={resolv($sensor)}
plugin_sid={translate($trans)}
date={normalize_date($date)}
userdata1={$mac}
userdata2={$usr1}
userdata3={$essid}
userdata4={$role}
userdata5={$vlan}


[AUTHMGR-Auth]
#Aug 16 10:11:55 2010 [13.37.13.37] authmgr[18121]: <522039> <INFO> |authmgr|  MAC=00:16:cf:3a:9a:0e IP=13.37.13.37 Authentication result=Authentication Successful method=Web server=vm07506.usc.es
#Aug 16 10:11:55 2010 [13.37.13.37] authmgr[18121]: <124003> <INFO> |authmgr|  Authentication result=Authentication Successful(0), method=Web, server=vm07506.usc.es, user=00:16:cf:3a:9a:0e
#Aug 15 22:11:13 2010 [13.37.13.37] authmgr[18121]: <522039> <INFO> |authmgr|  MAC=00:21:e9:e2:37:98 IP=13.37.13.37 Authentication result=Authentication failed method=802.1x server=vm07506.usc.es
#Aug 15 22:11:13 2010 [13.37.13.37] authmgr[18121]: <124003> <INFO> |authmgr|  Authentication result=Authentication failed(1), method=802.1x, server=vm07506.usc.es, user=00:21:e9:e2:37:98
event_type=event
date={normalize_date($date)}
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|authmgr\|\s+(MAC=(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+IP=(?P<ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s*)?Authentication\s+result=(?P<trans>Authentication\s+Successful|Authentication\s+failed|AAA\s+server\s+timeout)(\(\S+\),)?\s+method=(?P<method>[^,]+),?\s+server=(?P<server>[^,\s]+)\s*(,\s+user=(?P<user>\S+))?"
sensor={resolv($sensor)}
plugin_sid={translate($trans)}
src_ip={resolv($ip)}
dst_ip={resolv($server)}
username={$user}
userdata1={$method}
userdata2={$mac}

[AUTHMGR-User_entry]
#Aug 15 13:25:45 2010 [13.37.13.37] authmgr[18121]: <522006> <INFO> |authmgr|  MAC=00:16:6f:0b:bb:3b IP=13.37.13.37 User entry added: reason=Sibtye
#Aug 15 13:25:44 2010 [13.37.13.37] authmgr[18121]: <522005> <INFO> |authmgr|  MAC=00:17:f2:98:5e:18 IP=13.37.13.37 User entry deleted: reason=logon role lifetime reached
#Aug 15 06:37:48 2010 [13.37.13.37] authmgr[18121]: <522005> <INFO> |authmgr|  MAC=00:1d:1a:05:6e:71 IP=13.37.13.37 User entry deleted: reason=idle timeout
#Aug 15 07:38:14 2010 [13.37.13.37] authmgr[18121]: <522005> <INFO> |authmgr|  MAC=00:16:6f:0b:bb:3b IP=13.37.13.37 User entry deleted: reason=essid change
#Aug 16 06:40:39 2010 [13.37.13.37] authmgr[18121]: <522005> <INFO> |authmgr|  MAC=00:16:e3:e5:fb:83 IP=13.37.13.37 User entry deleted: reason=ip takeover
#Aug 15 06:38:43 2010 [13.37.13.37] authmgr[18121]: <522026> <INFO> |authmgr|  MAC=58:b0:35:02:dd:6c IP=13.37.13.37 User miss: ingress=0x1327, VLAN=39
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|authmgr\|\s+MAC=(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+IP=(?P<ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<trans>User\s+entry\s+added|User\s+entry\s+deleted|User\s+miss):\s+\S+=(?P<usr2>.*)(,\s+\S+=(?P<usr3>[^,]+))?(,\s+\S+=(?P<usr4>[^,]+))?"
sensor={resolv($sensor)}
plugin_sid={translate($trans)}
src_ip={resolv($ip)}
userdata1={$mac}
userdata2={$usr2}
userdata3={$usr3}
userdata4={$usr4}
date={normalize_date($date)}

[AUTHMGR-Selected_server]
#Aug 15 09:55:30 2010 [13.37.13.37] authmgr[18121]: <124038> <INFO> |authmgr|  Selected server vm07506.usc.es for method=802.1x; user=soraya.rodriguez@rai.usc.es,  essid=wifiusc, domain=rai.usc.es, server-group=wifiusc
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|authmgr\|\s+Selected\s+server\s(?P<server>\S+)\s+for\s+method=(?P<method>[^;]*);\s+user=(?P<user>.*),\s+essid=(?P<essid>.*),\s+domain=(?P<domain>.*),\s+server-group=(?P<group>.*)"
sensor={resolv($sensor)}
plugin_sid=44
date={normalize_date($date)}
dst_ip={resolv($server)}
username={$user}
userdata1={$method}
userdata2={$essid}
userdata3={$domain}
userdata4={$group}

[AUTHMGR-Radius_Reject]
#Aug 15 06:35:30 2010 [13.37.13.37] authmgr[18121]: <132207> <ERRS> |authmgr|  RADIUS reject for station soraya.rodriguez@rai.usc.es 00:21:e9:e2:37:98 from server vm07506.usc.es.
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|authmgr\|\s+RADIUS\s+reject\s+for\s+station\s(?P<user>.*)\s+(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+from\s+server\s+(?P<server>\S+)\."
sensor={resolv($sensor)}
plugin_sid=45
date={normalize_date($date)}
src_ip={resolv($server)}
username={$user}
userdata1={$mac}

[AUTHMGR-User_authenticated]
#Aug 15 07:23:29 2010 [13.37.13.37] authmgr[18121]: <522008> <NOTI> |authmgr|  User authenticated: Name=carolyn.perkins@rai.usc.es MAC=00:19:d2:82:a0:57 IP=13.37.13.37 method=Web server=vm07506.usc.es role=wifiWEB
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|authmgr\|\s+User\s+authenticated:\s+Name=(?P<user>.*)\s+MAC=(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+IP=(?P<ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+method=(?P<method>.*)\s+server=(?P<server>.*)\s+role=(?P<role>.*)"
sensor={resolv($sensor)}
plugin_sid=46
date={normalize_date($date)}
src_ip={resolv($ip)}
dst_ip={resolv($server)}
username={$user}
userdata1={$mac}
userdata2={$method}
userdata3={$role}

[AUTHMGR-User_deauthenticated]
#Aug 26 12:21:11 2010 [13.37.13.37] authmgr[1671]: <522010> <NOTI> |authmgr|  MAC=00:13:02:89:5d:8f IP=13.37.13.37 User de-authenticated: name=EVAMARIA.BARREIRA@rai.usc.es, cause=user request
#Aug 26 12:23:48 2010 [13.37.13.37] authmgr[1671]: <522010> <NOTI> |authmgr|  MAC=00:24:d6:3b:60:8e IP=13.37.13.37 User de-authenticated: name=eduardo.garcia2@rai.usc.es, cause=session timeout
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{2}\:\d{2}\:\d{2}\s\d{4})\s\[(?P<sensor>\S+)\]\s+\S+\s+\S+\s+\S+\s+\|authmgr\|\s+MAC=(?P<mac>\S{2}:\S{2}:\S{2}:\S{2}:\S{2}:\S{2})\s+IP=(?P<ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+User\s+de-authenticated:\s+name=(?P<user>.*),\s+cause=(?P<cause>.*)"
sensor={resolv($sensor)}
plugin_sid=47
date={normalize_date($date)}
src_ip={resolv($ip)}
username={$user}
userdata1={$mac}
userdata2=($cause)

